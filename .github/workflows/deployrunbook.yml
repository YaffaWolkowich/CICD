name: Deploy Kontext automation runbooks for each
on:
  workflow_dispatch:
permissions:
  contents: read
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        files:
          - date_check
          - get_ad_users
          - process_management
          - update_user_attribute
    steps:
      - uses: actions/checkout@v3
      - uses: azure/login@v1
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
          enable-AzPSSession: true
      - name: Get result
        run: echo ${{ matrix.files }}
      # - name: Deploy Azure runbooks
      #   uses: azure/powershell@v1
      #   with:

      #     inlineScript: |
      #       pushd ./scripts/runbooks
      #       Import-AzAutomationRunbook -Path ${{ matrix.files }}.py  -Name ${ matrix.files } -Type Python3 -AutomationAccountName 'tryingCT' -ResourceGroupName 'cloud-shell-storage-westeurope' -Force
      #       Publish-AzAutomationRunbook -Name ${{ matrix.files }} -AutomationAccountName 'tryingCT'  -ResourceGroupName 'cloud-shell-storage-westeurope'
      #       popd
      #     azPSVersion: "latest"

      - name: logout
        run: |
          az logout
